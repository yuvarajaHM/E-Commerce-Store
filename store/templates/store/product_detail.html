{% extends "store/base.html" %}

{% block content %}
<div class="product-detail">
    {% if product.image_url %}
        <img src="{{ product.image_url }}" alt="{{ product.name }}" class="product-image-large" />
    {% endif %}
    <div class="product-info">
        <h1>{{ product.name }}</h1>
        {% if product.rating_count %}
            <p>Rating: {{ product.average_rating|floatformat:1 }}/5 ({{ product.rating_count }} review{% if product.rating_count != 1 %}s{% endif %})</p>
        {% else %}
            <p>No ratings yet.</p>
        {% endif %}
        <p class="price">â‚¹{{ product.price }}</p>
        <p>{{ product.description }}</p>
        <div class="product-actions">
            <a class="btn primary" href="{% url 'add_to_cart' product.pk %}">Add to cart</a>
            <a class="btn" href="/">Back to products</a>
        </div>
    </div>
</div>

<section class="reviews">
    <h2>Reviews</h2>
    {% if reviews %}
        <ul class="review-list">
            {% for review in reviews %}
                <li class="review-item">
                    <strong>{{ review.name }}</strong>
                    <span>- {{ review.rating }}/5</span>
                    {% if review.comment %}
                        <p>{{ review.comment }}</p>
                    {% endif %}
                    <small>{{ review.created_at }}</small>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No reviews yet. Be the first to review this product.</p>
    {% endif %}

    <h3>Leave a review</h3>
    <form method="post" class="review-form">
        {% csrf_token %}
        <div class="form-row">
            <label for="name">Name (optional)</label>
            <input type="text" id="name" name="name" />
        </div>
        <div class="form-row">
            <label for="rating">Rating (1-5)</label>
            <input type="number" id="rating" name="rating" min="1" max="5" required />
        </div>
        <div class="form-row">
            <label for="comment">Comment (optional)</label>
            <textarea id="comment" name="comment" rows="3"></textarea>
        </div>
        <button type="submit" class="btn primary">Submit review</button>
    </form>
</section>
{% endblock %}
